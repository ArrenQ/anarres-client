<form nz-form [formGroup]="form">
  <nz-form-item>
    <nz-form-label [nzSpan]="7" nzRequired>{{ 'sys.config.code' | i18n }}</nz-form-label>
    <nz-form-control [nzSpan]="12" [nzErrorTip]="codeErrorTpl">
      <input nz-input formControlName="code" [placeholder]="'sys.config.value.placeHolder' | i18n" />
      <ng-template #codeErrorTpl let-control>
        <ng-container *ngIf="control.hasError('required')"> {{ 'sys.config.code.required' | i18n }} </ng-container>
        <ng-container *ngIf="control.hasError('pattern')"> {{ 'sys.config.code.pattern' | i18n }} </ng-container>
      </ng-template>
    </nz-form-control>
  </nz-form-item>
  <nz-form-item>
    <nz-form-label [nzSpan]="7" nzRequired>{{ 'sys.config.value' | i18n }}</nz-form-label>
    <nz-form-control [nzSpan]="12" [nzErrorTip]="valueErrorTpl">
      <input nz-input formControlName="value" [placeholder]="'sys.config.value.placeHolder' | i18n" />
      <ng-template #valueErrorTpl let-control let-form>
        <ng-container *ngIf="control.hasError('required')"> {{ 'sys.config.value.required' | i18n }} </ng-container>
        <ng-container *ngIf="control.hasError('pattern')"> {{ 'sys.config.value.pattern' | i18n }} </ng-container>
        <ng-container *ngIf="control.hasError('valueRegex')"> {{ 'sys.config.value.valueRegex' | i18n }} </ng-container>
      </ng-template>
    </nz-form-control>
  </nz-form-item>

  <nz-form-item>
    <nz-form-label [nzSpan]="7" nzRequired>{{ 'sys.config.valueRegex' | i18n }}</nz-form-label>
    <nz-form-control [nzSpan]="12" [nzErrorTip]="valueRegexErrorTpl">
      <nz-select
        formControlName="valueRegex"
        nzShowSearch
        [nzDropdownRender]="renderTemplate"
        [nzPlaceHolder]="'sys.config.valueRegex.placeHolder' | i18n"
      >
        <nz-option *ngFor="let item of valueRegexList" [nzLabel]="item.label" [nzValue]="item.value"></nz-option>
      </nz-select>
      <ng-template #renderTemplate>
        <nz-divider style="margin: 5px 0"></nz-divider>
        <div class="container">
          <input type="text" nz-input #inputElement />
          <a class="add-item" (click)="addItem(inputElement)"><i nz-icon nzType="plus"></i> {{ 'sys.config.valueRegex.custom' | i18n }} </a>
        </div>
      </ng-template>
      <ng-template #valueRegexErrorTpl let-control>
        <ng-container *ngIf="control.hasError('required')"> {{ 'sys.config.valueRegex.required' | i18n }} </ng-container>
        <ng-container *ngIf="control.hasError('regexp')"> {{ 'sys.config.valueRegex.regexp' | i18n }} </ng-container>
      </ng-template>
    </nz-form-control>
  </nz-form-item>
</form>

<div class="modal-footer">
  <button (click)="close()" nz-button type="button">关闭</button>
  <button (click)="save()" [nzLoading]="http.loading" nz-button nzType="primary" acl [acl-ability]="rolePrefix + actionType" type="submit">
    保存
  </button>
</div>
